# Sistema de archivos
```
┌───────────────────────────────────────────────┐
│            Volúmenes Lógicos (LV)             │  ← Se montan y usan directamente
│   /dev/vg_data/lv_home   /dev/vg_data/lv_var  │
└───────────────────────────────────────────────┘
                 ↑
┌───────────────────────────────────────────────┐
│           Grupo de Volúmenes (VG)             │  ← Espacio combinado de varios PV
│                 vg_data                       │
└───────────────────────────────────────────────┘
                 ↑
┌───────────────────────────────────────────────┐
│            Volúmenes Físicos (PV)             │  ← Discos o particiones reales
│          /dev/sdc1         /dev/sdc2          │
└───────────────────────────────────────────────┘

Los PV son los discos reales.
El VG es un “pool” de espacio.
Los LV son las “pseudo-particiones” flexibles que el sistema monta y usa.
```

```Bash
dmesg
# 1) Ver los discos conectados
lsblk

# 2) (Opcional) Borrar firmas antiguas — ¡borra todo!
sudo wipefs -a /dev/sdc
sudo wipefs -a /dev/sdd

# 3) Crear volúmenes físicos (PV)
sudo pvcreate /dev/sdc /dev/sdd

# 4) Crear grupo de volúmenes (VG)
sudo vgcreate vg_data /dev/sdc /dev/sdd

# 5) Crear volumen lógico (LV) que use todo el espacio disponible
sudo lvcreate -n lv_data -l 100%FREE vg_data

# 6) Formatear el volumen lógico con ext4
sudo mkfs.ext4 /dev/vg_data/lv_data

# 7) Crear punto de montaje y montar
sudo mkdir -p /mnt/nuevo_volumen
sudo mount /dev/vg_data/lv_data /mnt/nuevo_volumen

# 8) Verificar
lsblk
df -h /mnt/nuevo_volumen

# 9) (Opcional) Mostrar información LVM
sudo pvdisplay
sudo vgdisplay
sudo lvdisplay
```

# RAID

## En linux
```Bash
# 1) Instalar mdadm (Debian/Ubuntu)
sudo apt-get update && sudo apt-get install -y mdadm

# 2) Crear RAID 5 en /dev/md0 con 3 discos
sudo mdadm --create /dev/md0 --level=5 --raid-devices=3 /dev/sdb /dev/sdc /dev/sdd

# (Opcional) Ver progreso
cat /proc/mdstat

# 3) Formatear en ext4
sudo mkfs.ext4 /dev/md0

# 4) Montar
sudo mkdir -p /mnt/raid5
sudo mount /dev/md0 /mnt/raid5
```
## En Windows

- En Windows Server, el RAID (Redundant Array of Independent Disks) se configura a través de la herramienta Administración de discos o Espacios de almacenamiento para combinar varios discos en un solo volumen lógico, mejorando el rendimiento y la fiabilidad de los datos. Los tipos de RAID comunes en Windows Server son el RAID 0 (striping para rendimiento), el RAID 1 (mirroring para redundancia) y el RAID 5 (paridad para rendimiento y redundancia). Para configurarlo, es necesario inicializar los discos, convertirlos a discos dinámicos (si es necesario) y luego, en el menú contextual de un disco, seleccionar la opción para crear el tipo de volumen de RAID deseado, como "Nuevo volumen reflejado" o "Nuevo volumen" para otros tipos.

# Copias de seguridad

- Sistema de copias.
- Copias de seguridad en PowerShell.
- Rsync
```Bash
rsync -avh --delete /home/usuario/Documentos/ /media/usuario/backup_docs/
rsync -avh --delete /home/usuario/Documentos/ usuario@servidor:/backup/Documentos/
rsync -avh --delete usuario@servidor:/backup/Documentos/ /home/usuario/Documentos/
rsync -avh --progress /home/usuario/Documentos/ /media/usuario/backup_docs/
```
- Diseña un DRP simple para un pequeño negocio (una tienda local).
DRP (Plan de Recuperación ante Desastres) – Tienda Local
  1. Objetivo:
    - Garantizar la continuidad del sistema TPV en caso de pérdida total del servidor principal.
  2. Parámetros clave:
    - RPO: 24 horas → pérdida máxima de 1 día de datos.
    - RTO: 48 horas → tiempo máximo para volver a operar.
  3. Estrategia de backup (Regla 3-2-1):
    - 3 copias: original + NAS local + copia en la nube.
    - 2 medios diferentes: disco local (NAS) y nube.
    - 1 copia externa: almacenada fuera del local (nube).
    - Frecuencia: diaria.
    - Retención: 30 días.
  4. Procedimiento de recuperación TPV:
    - Confirmar fallo total del servidor.
    - Preparar servidor o equipo de respaldo.
    - Restaurar backup desde NAS o, si no existe, desde la nube.
    - Restaurar base de datos del TPV.
    - Verificar funcionamiento del sistema (ventas, impresoras, red).
    - Reactivar terminales de venta y reanudar operaciones.
    - Documentar el incidente y revisar el DRP.
  5. Responsables:
    - Técnico TI → recuperación técnica.
    - Gerente → coordinación y comunicación.
    - Proveedor nube → acceso a backup externo.

----------
----------

# Preguntas tipo test (de todos los temas)

¿Qué muestra el comando ls -l /?
a) El contenido de la carpeta personal del usuario
b) Los directorios principales del sistema Linux
c) Los procesos en ejecución

¿Qué directorio suele almacenar archivos de configuración del sistema?
a) /etc
b) /home
c) /tmp

¿Qué comando te permite consultar la jerarquía estándar del sistema de archivos (FHS)?
a) man list
b) man hier
c) man root

¿Qué herramienta se usa para crear particiones en un disco?
a) fdisk o gparted
b) ssh
c) mkhome

¿Qué hace el comando pvcreate?
a) Crea un archivo de texto vacío
b) Convierte una partición en un volumen físico para LVM
c) Crea un RAID 5 automáticamente

¿Para qué sirve vgcreate?
a) Crear un nuevo usuario
b) Crear un grupo de volúmenes a partir de varios PV
c) Crear un directorio compartido

¿Qué permite lvcreate?
a) Crear un volumen lógico dentro del grupo de volúmenes
b) Instalar paquetes
c) Cambiar permisos de usuario

¿Qué debes hacer antes de montar un LV o RAID en un directorio?
a) Cambiar el hostname
b) Formatearlo con un sistema de archivos (por ejemplo, mkfs.ext4)
c) Reiniciar el ordenador

Si añades tres discos de 1GB a una VM Linux y quieres RAID 5, usas el comando:
a) mdadm --create /dev/md0 --level=5 --raid-devices=3 <discos>
b) raid --new
c) create-raid5 /dev/md0

¿Qué característica tiene RAID 5?
a) Copias idénticas (mirroring) de todos los discos
b) Divide datos + paridad distribuida, permitiendo que falle 1 disco
c) No ofrece tolerancia a fallos

¿Qué comando formatea un RAID recién creado para poder usarlo?
a) mkraid.ext4
b) mkfs.ext4 /dev/md0
c) format-raid /dev/md0

¿Qué debes hacer para usar el RAID 5 tras formatearlo?
a) Compilar el kernel
b) Montarlo en un directorio (por ejemplo, /mnt/raid5)
c) Desinstalar mdadm

¿Dónde se encuentran los directorios personales de los usuarios?
a) /home
b) /root
c) /user
